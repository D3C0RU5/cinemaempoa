{% extends 'base.html' %}

{% block header %}
    <h1>{% block title %}Filmes em Porto Alegre{% endblock %}</h1>
    <p>Filmes em cartaz hoje, <time><strong>{{ today }}</strong></time>.</p>
    <div class="dropdown mb-5">
        <a href="#" class="btn btn-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Acesso rápido
        </a>
        <ul class="dropdown-menu">
            <li><h6 class="dropdown-header">Ir para...</h6></li>
            {% for link in quicklinks %}
                <li><a href="#{{ link[0] }}" class="dropdown-item">{{ link[1] }}</a></li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}

{% block content %}
    {% for cinema in cinemas_with_screenings %}
        <article>
            <header>
                <h2 id="{{ cinema.slug }}">
                    {{ cinema.name }}
                </h2>
                <p>
                    <a href="{{ cinema.url }}">Visite o site</a> do cinema.
                </p>
                <!-- warnings go here -->
            </header>
            <main>
                {% if cinema['screening_dates'] %}
                    <ul class="list-unstyled">
                        {% for screening_date in cinema['screening_dates'] %}
                            <li class="mb-5">
                                {% if screening_date['image'] %}
                                    <img src="/screening/assets/{{ screening_date['image'] }}" width="325" loading="lazy"/>
                                {% endif %}
                                <h3>{{ screening_date['title'] }}</h3>
                                {% if screening_date['times']|length %}
                                <div class="mb-3">
                                    <p class="lead">Horários:</p>
                                    <ul>
                                        {% for time in screening_date['times'] %}
                                        <li>
                                            {{ time }}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                                {% endif %}
                                <p style="white-space: break-spaces;">{{ screening_date['description']|safe }}</p>
                                <p><a href="{{ screening_date['screening_url'] }}">Mais informações</a></p>
                                <small class="text-muted">
                                    Achou um erro?
                                    {% if g.user %}
                                        <a class="action" href="{{ url_for('screening.update', id=screening_date['screening_id']) }}">Edite!</a>
                                    {% else %}
                                        <a class="action" href="{{ url_for('screening.update', id=screening_date['screening_id']) }}">Ajude a corrigir!</a>
                                    {% endif %}
                                </small>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <strong class="text-danger">Não há sessões hoje.</strong>
                {% endif %}
            </main>
        </article>
        {% if not loop.last %}
            <hr/>
        {% endif %}
    {% endfor %}
{% endblock %}